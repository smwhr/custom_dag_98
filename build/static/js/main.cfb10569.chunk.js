(this["webpackJsonpcustom-dag-98"]=this["webpackJsonpcustom-dag-98"]||[]).push([[0],{17:function(e,t,n){},25:function(e,t,n){"use strict";n.r(t);var c=n(8),i=(n(17),n(18),n(1));let a=(e,t)=>Array.from({length:t-e+1},((t,n)=>e+n));var l=n(2),s=n(0);const r=e=>{let{children:t}=e;return Object(s.jsx)(l.a,{width:8,height:2,children:t})},j=e=>{let{children:t}=e;return Object(s.jsx)(l.a,{height:1,top:4,left:5,width:8,style:{textAlign:"right"},children:t})},o=e=>{let{onNext:t,cancel:n}=e;return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsxs)(r,{children:[Object(s.jsx)("p",{children:"This wizard will help you create your custom DAG quickly and easily."}),Object(s.jsx)("p",{children:"To begin creating your custom DAG, click Next."})]}),Object(s.jsxs)(j,{children:[Object(s.jsx)("button",{disabled:!0,children:"< Back"}),Object(s.jsx)("button",{onClick:t,children:"Next >"}),"\xa0",Object(s.jsx)("button",{onClick:n,style:{marginLeft:"1em"},children:"Cancel"})]})]})},d=e=>{let{initialAgency:t,availableAgencies:n,onBack:c,onAgency:a,cancel:l}=e,[o,d]=Object(i.useState)(t);return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsxs)(r,{children:[Object(s.jsx)("h2",{children:"Select Agency"}),Object(s.jsx)("p",{children:"Select the agency :"}),Object(s.jsx)("div",{children:Object(s.jsx)("select",{onChange:e=>d(e.target.value),defaultValue:t,children:n.map((e=>Object(s.jsx)("option",{value:e,children:e},e)))})})]}),Object(s.jsxs)(j,{children:[Object(s.jsx)("button",{onClick:c,children:"< Back"}),Object(s.jsx)("button",{onClick:()=>{a(o)},children:"Next >"}),"\xa0",Object(s.jsx)("button",{onClick:l,style:{marginLeft:"1em"},children:"Cancel"})]})]})};function b(e,t,n){let c=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.name=e,this.label=t,this.key=e,this.value=c,this.toggle=()=>{this.value=!this.value},this.render=()=>Object(s.jsxs)("div",{children:[Object(s.jsx)("input",{id:"task_".concat(this.name),type:"checkbox",value:this.name,checked:this.value,onClick:()=>this.toggle(),onChange:n},this.name),Object(s.jsx)("label",{htmlFor:"task_".concat(this.name),children:this.label})]},"task_".concat(this.key))}const h=[{id:"1",name:"January"},{id:"2",name:"February"},{id:"3",name:"March"},{id:"4",name:"April"},{id:"5",name:"May"},{id:"6",name:"June"},{id:"7",name:"July"},{id:"8",name:"August"},{id:"9",name:"September"},{id:"10",name:"October"},{id:"11",name:"November"},{id:"12",name:"December"}],m=e=>{let{initialPerimeter:t,availableYears:n,onBack:c,onTimePerimeter:o,cancel:d}=e;const m="string"===typeof t?"all":0===t.length?"none":"year_month",u="year_month"==m?t[0].split("_")[0]:n[0],x=Array.isArray(t)?t.map((e=>e.split("_")[1])):[];let[O,p]=Object(i.useState)(m),[g,k]=Object(i.useState)(u),[y,v]=Object(i.useState)(x);const C=h.map((e=>{let{id:t,name:n}=e;return new b(t,n,(()=>{const e=_.filter((e=>e.value)).map((e=>e.name));v(e),f.value=0==e.length,w.value=12==e.length}),y.includes(t))}));let[_]=Object(i.useState)(C),[w]=Object(i.useState)(new b("all","Select all",(()=>{_.map((e=>(e.value=!0,e))),w.value=!0,f.value=!1,v(h.map((e=>{let{id:t}=e;return t})))}))),[f]=Object(i.useState)(new b("none","Deselect all",(()=>{_.map((e=>(e.value=!1,e))),f.value=!0,w.value=!1,v([])})));return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsxs)(r,{children:[Object(s.jsx)("h2",{children:"Select time perimeter"}),Object(s.jsxs)("fieldset",{disabled:"year_month"!=O,children:[Object(s.jsxs)("legend",{children:[Object(s.jsx)("input",{type:"radio",id:"year_month_perimeter_type",name:"time_perimeter_type",value:"year_month",checked:"year_month"==O,onChange:e=>p(e.target.value)}),Object(s.jsx)("label",{htmlFor:"year_month_perimeter_type",children:"Use a specific time perimeter (Recommended)"})]}),Object(s.jsxs)("div",{children:[Object(s.jsx)("label",{children:"Please choose a year :"}),Object(s.jsx)("select",{onChange:e=>k(parseInt(e.target.value,10)),children:n.map((e=>Object(s.jsx)("option",{value:e,children:e},e)))})]}),Object(s.jsxs)("fieldset",{children:[Object(s.jsx)("legend",{children:"Months"}),Object(s.jsxs)(l.b,{children:[Object(s.jsx)(l.a,{width:4,children:_.slice(0,5).map((e=>e.render()))}),Object(s.jsx)(l.a,{width:4,children:_.slice(5,10).map((e=>e.render()))}),Object(s.jsxs)(l.a,{width:4,children:[_.slice(10,12).map((e=>e.render())),Object(s.jsx)("br",{}),w.render(),f.render()]})]})]})]}),Object(s.jsx)("input",{type:"radio",id:"all_perimeter_type",name:"time_perimeter_type",value:"all",checked:"all"==O,onChange:e=>p(e.target.value)}),Object(s.jsx)("label",{htmlFor:"all_perimeter_type",children:"Launch on all available year and months (Slow)"}),Object(s.jsx)("input",{type:"radio",id:"none_perimeter_type",name:"time_perimeter_type",value:"none",checked:"none"==O,onChange:e=>p(e.target.value)}),Object(s.jsx)("label",{htmlFor:"none_perimeter_type",children:"Only compute the referential (Fast)"})]}),Object(s.jsxs)(j,{children:[Object(s.jsx)("button",{onClick:c,children:"< Back"}),Object(s.jsx)("button",{onClick:()=>{if("year_month"==O){const e="".concat(g),t=0==y.length?a(1,12).map((t=>"".concat(e,"_").concat(t))):y.map((t=>"".concat(e,"_").concat(t)));o(t)}else"all"==O?o("all"):"none"==O&&o([])},children:"Next >"}),"\xa0",Object(s.jsx)("button",{onClick:d,style:{marginLeft:"1em"},children:"Cancel"})]})]})},u=e=>{let{initialTasks:t,availableTasks:n,onBack:c,cancel:a,onTasks:l}=e,[o,d]=Object(i.useState)(t);const h=n.map((e=>new b(e,e,(()=>{d(m.filter((e=>e.value)).map((e=>e.name)))}),t.includes(e))));let[m]=Object(i.useState)(h);return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsxs)(r,{children:[Object(s.jsx)("h2",{children:"Select Tasks"}),Object(s.jsx)("p",{children:"Select the task(s) to :"}),Object(s.jsx)("div",{children:m.map((e=>e.render()))})]}),Object(s.jsxs)(j,{children:[Object(s.jsx)("button",{onClick:c,children:"< Back"}),Object(s.jsx)("button",{onClick:()=>{l(o)},disabled:o.length<1,children:"Next >"}),"\xa0",Object(s.jsx)("button",{onClick:a,style:{marginLeft:"1em"},children:"Cancel"})]})]})},x=e=>{let{initialKpi:t,availableKpis:n,onBack:c,cancel:a,onKpi:l}=e,[o,d]=Object(i.useState)(t);return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsxs)(r,{children:[Object(s.jsx)("h2",{children:"Select Kpi"}),Object(s.jsx)("p",{children:"Select the kpi :"}),Object(s.jsx)("div",{children:Object(s.jsx)("select",{onChange:e=>d(e.target.value),defaultValue:t,children:n.map((e=>Object(s.jsx)("option",{value:e,children:e},e)))})})]}),Object(s.jsxs)(j,{children:[Object(s.jsx)("button",{onClick:c,children:"< Back"}),Object(s.jsx)("button",{onClick:()=>{l(o)},children:"Next >"}),"\xa0",Object(s.jsx)("button",{onClick:a,style:{marginLeft:"1em"},children:"Cancel"})]})]})},O=e=>{let{onBack:t,onNext:n,cancel:c}=e;return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsxs)(r,{children:[Object(s.jsx)("h2",{children:"Wizard completed"}),Object(s.jsx)("p",{children:"The custom DAG wizard saved all informations."}),Object(s.jsx)("p",{children:"Click Finish to generate your custom DAG json."}),Object(s.jsx)("div",{style:{marginTop:"5em"}}),Object(s.jsxs)(l.b,{children:[Object(s.jsx)(l.a,{width:6,children:Object(s.jsx)("button",{disabled:!0,children:"Add custom builds"})}),Object(s.jsx)(l.a,{width:6,center:!0,middle:!0}),Object(s.jsx)(l.a,{width:6,children:Object(s.jsx)("button",{disabled:!0,children:"Add a custom notification"})}),Object(s.jsx)(l.a,{width:6,center:!0,middle:!0})]})]}),Object(s.jsxs)(j,{children:[Object(s.jsx)("button",{onClick:t,children:"< Back"}),Object(s.jsx)("button",{onClick:n,children:"Finish"}),"\xa0",Object(s.jsx)("button",{onClick:c,style:{marginLeft:"1em"},children:"Cancel"})]})]})};var p=n(12);const g=e=>{let{customDag:t,onBack:n}=e;const c=JSON.stringify((e=>{var t;let n={};return console.log(e.tasks.includes("initialize-kpis")),(null===(t=e.kpi)||void 0===t?void 0:t.length)>0&&e.tasks.includes("initialize-kpis")&&(n={kpi:e.kpi}),console.log(n),{[e.agency]:{time_perimeter:e.time_perimeter,tasks:e.tasks,...n}}})(t));return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsxs)(r,{children:[Object(s.jsx)("textarea",{style:{width:"100%",height:"220px"},value:c,readOnly:!0}),Object(s.jsx)(p.CopyToClipboard,{text:c,children:Object(s.jsx)("button",{children:"Copy to clipboard"})})]}),Object(s.jsx)(j,{children:Object(s.jsx)("button",{onClick:n,children:"Cancel"})})]})},k={};function y(e,t){switch(t.type){case"reset":return{};case"agency":return{...e,agency:t.payload};case"time_perimeter":return{...e,time_perimeter:t.payload};case"tasks":return{...e,tasks:t.payload};case"kpi":return{...e,kpi:t.payload};default:throw new Error}}function v(){let[e,t]=Object(i.useState)([]),[n,c]=Object(i.useState)([]),[j,b]=Object(i.useState)("loading");const[h,p]=Object(i.useReducer)(y,k);Object(i.useEffect)((()=>{console.log("Fetching agencies");const e=fetch("https://all-agencies.gateway.cit.io/agency.json").then((e=>e.json())).then((e=>e.map((e=>e.name)))).then((e=>t(e.sort())));console.log("Fetching kpis");const n=fetch("https://docs.api.staging.cit.io/_sources/api/kpis.rst.txt").then((e=>e.text())).then((e=>e.match(/kpis\.(.*)/g))).then((e=>e.map((e=>e.split(".")[1])))).then((e=>{c(e.sort())}));Promise.all([e,n]).then((()=>b("initial")))}),[]);const v=a(2018,(new Date).getFullYear()).reverse(),C=["write-ctfs-to-gcloud","initialize-ctfs","clean-models","initialize-cs-models","initialize-kpis","initialize-serialized-courses","initialize-service-dates","generate-report","clusterize-kpis","run-prediction"],_=()=>{p({type:"reset"}),b("initial")},w=Object(i.useRef)(null),[f,z]=Object(i.useState)("normal");return Object(s.jsxs)("div",{className:"App",children:[Object(s.jsxs)("div",{className:"window",ref:w,style:{width:"normal"==f?"490px":"minimized"==f?"200px":"maximized"==f?"100%":"480px"},children:[Object(s.jsxs)("div",{className:"title-bar",children:[Object(s.jsx)("div",{className:"title-bar-text",children:"Custom DAG Wizard"}),Object(s.jsxs)("div",{className:"title-bar-controls",children:["minimized"!=f?Object(s.jsx)("button",{"aria-label":"Minimize",onClick:()=>{z("minimized")}}):null,"maximized"!=f&&"minimized"!=f?Object(s.jsx)("button",{"aria-label":"Maximize",onClick:()=>{z("maximized")}}):null,"normal"!=f?Object(s.jsx)("button",{"aria-label":"Restore",onClick:()=>{z("normal")}}):null,Object(s.jsx)("button",{"aria-label":"Close",onClick:()=>{window.confirm("Are you sure your want to quit the wizard ?")&&w.current.remove()}})]})]}),Object(s.jsx)("div",{className:"window-body",style:{display:"minimized"==f?"none":"block"},children:Object(s.jsxs)(l.b,{columns:12,flow:"row dense",children:[Object(s.jsx)(l.a,{width:4,height:4,children:Object(s.jsx)("img",{src:"/initial.png",alt:""})}),Object(s.jsx)(s.Fragment,{children:"loading"==j?Object(s.jsxs)(r,{children:["Preparing the wizard... ",Object(s.jsx)("br",{}),Object(s.jsx)("br",{}),"Agencies ",0==e.length?"loading...":"loaded."," ",Object(s.jsx)("br",{}),Object(s.jsx)("br",{}),"KPI ",0==n.length?"loading...":"loaded."]}):"initial"==j?Object(s.jsx)(o,{onNext:()=>{b("agency")},cancel:_}):"agency"==j?(()=>{const t=h.agency||e[0]||"";return Object(s.jsx)(d,{initialAgency:t,availableAgencies:e,onBack:()=>{b("initial")},cancel:_,onAgency:e=>{p({type:"agency",payload:e}),b("date")}})})():"date"==j?(()=>{const e=h.time_perimeter||["".concat(v[0],"_").concat((new Date).getMonth())];return Object(s.jsx)(m,{initialPerimeter:e,availableYears:v,onBack:()=>{b("agency")},cancel:_,onTimePerimeter:e=>{p({type:"time_perimeter",payload:e}),b("task")}})})():"task"==j?(()=>{const e=h.tasks||[];return Object(s.jsx)(u,{initialTasks:e,availableTasks:C,onBack:()=>{b("date")},cancel:_,onTasks:e=>{p({type:"tasks",payload:e}),e.includes("initialize-kpis")?b("kpi"):b("end")}})})():"kpi"==j?(()=>{const e=h.kpi||n[0]||"";return Object(s.jsx)(x,{initialKpi:e,availableKpis:n,onBack:()=>{b("task")},cancel:_,onKpi:e=>{p({type:"kpi",payload:e}),b("end")}})})():"end"==j?Object(s.jsx)(O,{onBack:()=>{b("task")},onNext:()=>{b("json")},cancel:_}):"json"==j?Object(s.jsx)(g,{customDag:h,onBack:()=>{b("end")}}):Object(s.jsx)("p",{children:"Step undefined !"})})]})})]}),Object(s.jsx)("div",{})]})}const C=document.getElementById("root");Object(c.render)(Object(s.jsx)(v,{}),C)}},[[25,1,2]]]);
//# sourceMappingURL=main.cfb10569.chunk.js.map